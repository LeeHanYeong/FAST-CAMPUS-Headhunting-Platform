{% extends 'base_header.jinja2' %}

{% block header_title %}
<span>지원자 현황</span>
{% endblock %}

{% block header_content %}
<div class="right-menu child-middle">
	<div class="dropdown d-inline-block h-input">
		<button class="btn btn-dark dropdown-toggle pl-4 pr-4 mr-2" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	    {% set cur_group = request.GET.get('groups') %}
			{% if cur_group %}
		    {% for group in group_list.values('pk', 'title') %}
			    {% if cur_group|int == group.pk %}
				    {{ group.title }}
			    {% endif %}
		    {% endfor %}
			{% else %}
				직군
			{% endif %}
	  </button>
	  <div class="dropdown-menu">
	    <a class="dropdown-item"
	         href="{{ url('members:applicant-list') }}{{ query(request) }}">전체</a>
	    {% for category in category_list %}
		    <div class="dropdown-divider"></div>
		    <h6 class="dropdown-header">{{ category.title }}</h6>
		    {% for group in category.group_set.all() %}
		      <a href="{{ url('members:applicant-list') }}{{ query(request, groups=group.pk) }}" class="dropdown-item">{{ group.title }}</a>
		    {% endfor %}
	    {% endfor %}
	  </div>
	</div>

	<div class="dropdown d-inline-block h-input">
		<button class="btn btn-dark dropdown-toggle pl-4 pr-4 mr-2" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	    {% set cur_looking = request.GET.get('is_looking') %}
			{% if cur_looking %}
		    {% for looking, looking_display in choices_looking %}
			    {% if cur_looking == looking %}
				    {{ looking_display }}
			    {% endif %}
		    {% endfor %}
			{% else %}
				지원자 타입
			{% endif %}
	  </button>
	  <div class="dropdown-menu">
	    <a class="dropdown-item"
	         href="{{ url('members:applicant-list') }}{{ query(request, is_looking='') }}">전체</a>
		  {% for looking, looking_display in choices_looking %}
	      <a class="dropdown-item"
	         href="{{ url('members:applicant-list') }}{{ query(request, is_looking=looking) }}">{{ looking_display }}</a>
		  {% endfor %}
	  </div>
	</div>
	<form action="" class="d-inline-block h-input">
		<input name="full_name" value="{{ request.GET.get('full_name', '') }}"
		       type="text" class="form-control" placeholder="학생/키워드 검색하기">
	</form>
</div>
{% endblock %}

{% block content %}
<div class="applicant-list container-fluid">
	<div class="row">
	{% for applicant in applicants %}
		<div class="col-lg-6 mb-5">
			<div class="user">
				<div class="user-profile shadow-xs" style="background-image: url('{{ applicant.img_profile.url }}');">
					{% if request.user.is_authenticated %}
					<button v-on:click.self="toggleUserLike($event)"
					        class="btn-star btn btn-sm
					        {% if request.user in applicant.followers.all() %}
					          btn-primary
					        {% else %}
					          btn-outline-primary
									{% endif %}"
					        data-user-pk="{{ applicant.pk }}">
						<span class="icon far fa-star"></span>
					</button>
					{% endif %}
				</div>
				<a href="{{ url('members:applicant-detail', args=[applicant.pk]) }}" class="content">
					<div class="name-course">
						<span class="name mr-2">{{ applicant.name }}</span>
						<span>{{ applicant.job_groups.values_list('title', flat=True)|join(', ') }}</span>
					</div>
					<p class="short-intro">{{ applicant.short_intro }}</p>
					<div class="badge-list">
						{% for skill in applicant._skills.all() %}
							<span class="badge badge-pill badge-light">#{{ skill.title }}</span>
						{% endfor %}
					</div>
					<button class="btn-status shadow-xs btn btn-lg pl-5 pr-5
									{% if applicant.is_looking != 'c' %}
										btn-primary
									{% else %}
										btn-secondary
									{% endif %}">
						{{ applicant.get_is_looking_display() }}
					</button>
				</a>
			</div>
		</div>
	{% endfor %}
	</div>
</div>
{% endblock %}

{% block script %}
<script>

</script>
{% endblock %}